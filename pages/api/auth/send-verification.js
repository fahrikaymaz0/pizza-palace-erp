import nodemailer from 'nodemailer';import jwt from 'jsonwebtoken';// E-posta yapılandırmasıconst transporter = nodemailer.createTransport({  service: 'gmail',  auth: {    user: process.env.EMAIL_USER,    pass: process.env.EMAIL_PASS  }});export default async function handler(req, res) {  if (req.method !== 'POST') {    return res.status(405).json({ message: 'Sadece POST istekleri destekleniyor' });  }  try {    const { email } = req.body;    if (!email) {      return res.status(400).json({ message: 'E-posta adresi gereklidir' });    }    // Doğrulama tokeni oluştur    const verificationToken = jwt.sign(      { email },      process.env.JWT_SECRET || 'fallback-secret',      { expiresIn: '24h' }    );    // Doğrulama linki    const verificationUrl = `${process.env.NEXT_PUBLIC_BASE_URL || 'http://localhost:3000'}/verify-email?token=${verificationToken}`;    // E-posta içeriği    const mailOptions = {      from: process.env.EMAIL_USER,      to: email,      subject: '🍕 Pizza Krallığı - E-posta Doğrulama',      html: `        <div style="max-width: 600px; margin: 0 auto; font-family: Arial, sans-serif;">          <div style="background: linear-gradient(135deg, #DC2626, #F59E0B); padding: 30px; text-align: center; color: white;">            <h1 style="margin: 0; font-size: 28px;">👑 Pizza Krallığı</h1>            <p style="margin: 10px 0 0 0; font-size: 16px;">E-posta Doğrulama</p>          </div>                    <div style="padding: 40px 30px; background: #f9fafb;">            <h2 style="color: #374151; margin-bottom: 20px;">Merhaba!</h2>            <p style="color: #6b7280; line-height: 1.6; margin-bottom: 30px;">              Pizza Krallığı'na hoş geldiniz! E-posta adresinizi doğrulamak için aşağıdaki butona tıklayın.            </p>                        <div style="text-align: center; margin: 40px 0;">              <a href="${verificationUrl}"                  style="background: linear-gradient(135deg, #DC2626, #F59E0B);                         color: white;                         padding: 15px 30px;                         text-decoration: none;                         border-radius: 25px;                         font-weight: bold;                         display: inline-block;                        box-shadow: 0 4px 12px rgba(220, 38, 38, 0.3);">                E-postamı Doğrula              </a>            </div>                        <p style="color: #9ca3af; font-size: 14px; line-height: 1.5;">              Bu link 24 saat boyunca geçerlidir. Eğer bu işlemi siz yapmadıysanız, bu e-postayı görmezden gelebilirsiniz.            </p>          </div>                    <div style="background: #374151; padding: 20px; text-align: center; color: #9ca3af; font-size: 14px;">            © 2024 Pizza Krallığı. Tüm hakları saklıdır.          </div>        </div>      `    };    // E-posta gönder    await transporter.sendMail(mailOptions);    res.status(200).json({       success: true,       message: 'Doğrulama e-postası gönderildi. E-posta kutunuzu kontrol edin.'     });  } catch (error) {    console.error('E-posta gönderme hatası:', error);    res.status(500).json({       success: false,       message: 'E-posta gönderilirken bir hata oluştu.'     });  }}